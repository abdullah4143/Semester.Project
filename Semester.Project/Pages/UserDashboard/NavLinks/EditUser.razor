@page "/profile/edit-user/{email}"
@inject UserService UserService
@layout ProfileLayout

<div class="m-5">

<EditForm Model="_user" OnValidSubmit="HandleValidSubmit">
    <div class="form-group">
        <label for="Name">Name</label>
        <InputText @bind-Value="_user.Name" id="Name" class="form-control" />
    </div>

    <div class="form-group">
        <label for="Username">Username</label>
        <InputText @bind-Value="_user.username" id="Username" placeholder class="form-control" />
    </div>


    <div class="form-group">
        <label for="Email">Email</label>
        <InputText @bind-Value="_user.Email" id="Email" class="form-control" />
    </div>


    <div class="form-group">
        <label for="Password">Password</label>
        <InputText @bind-Value="_user.password" id="Password" class="form-control" />
    </div>

    <div class="form-group">
        <button type="submit" class="btn btn-outline-success">Update Details</button> 
    </div>
</EditForm>

@if (updated != null)
{
    if (updated == true)
    {
        <div class="alert alert-success" role="alert">
            User details updated successfully
        </div>
    }
    else
    {
        <div class="alert alert-danger" role="alert">
            User details not updated one or more details might already been taken
        </div>
    }
}

</div>

@code {
    [Parameter]
    public string email { get; set; }

    private bool ?updated { get; set; } =  null;

    private User _user = new User();

    private void HandleValidSubmit()
    {
        updated = UserService.UpdateUser(_user);
    }


    protected override void OnInitialized()
    {
        _user = UserService.GetUserByEmail(email);
    }
}
